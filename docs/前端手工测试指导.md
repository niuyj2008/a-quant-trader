# 前端手工测试指导

本文档提供**详细的前端手工测试步骤**，帮助您验证Web界面（v3.0）的所有功能。

系统共 **11 个 Tab**：个股策略、持仓策略、个股推荐、行情分析、因子研究、策略回测、交易记录、ETF定投、目标规划、策略优化、专业报告。

---

## 准备工作

### 1. 启动Web应用

```bash
cd /Users/niuyj/Downloads/workspace_Claude/stock/a-quant-trader
streamlit run src/web/app.py
```

**预期**: 浏览器自动打开 `http://localhost:8501`

### 2. 检查初始界面

- ✅ 页面标题为"📊 量化策略决策支持系统"
- ✅ 左侧边栏显示：市场选择（A股/美股）、股票代码输入、日期范围选择
- ✅ 顶部有 **11 个 Tab 标签**
- ✅ 无报错信息

### 3. 侧边栏配置

**操作步骤**:
1. 市场选择：默认"A股"
2. 股票代码：输入 `600519`（贵州茅台）
3. 日期范围：设置起始和结束日期

**测试数据**:
- A股有效代码: `600519`, `000001`, `000858`, `601318`
- 美股有效代码: `AAPL`, `MSFT`, `GOOGL`

---

## Tab 1: 📊 个股策略

### 1.1 策略选择与分析

**操作步骤**:
1. 点击"📊 个股策略" Tab
2. 在策略选择下拉框中选择一个策略（如"多因子均衡"）
3. 点击"🔍 分析此股票"按钮

**预期结果**:
- ✅ 显示综合决策建议（买入/卖出/持有）
- ✅ 显示信心水平百分比
- ✅ 显示核心理由列表（带✓标记）
- ✅ 显示风险提示（带⚠标记）

### 1.2 多策略对比

**操作步骤**:
1. 勾选"📊 查看多策略对比"复选框

**预期结果**:
- ✅ 显示6个策略的信号对比表（策略名、信号方向、信心、核心理由）
- ✅ 信号用颜色标记（买入绿色、卖出红色、持有橙色）
- ✅ 显示多策略信号分布饼图

### 1.3 基本面评分卡片

**检查项**:
- ✅ 分析结果下方显示"📋 基本面评分"区域
- ✅ 四维度评分：盈利能力、成长性、估值水平、财务健康
- ✅ 每个维度显示分数和评级（优秀/良好/一般/较差）
- ✅ 显示综合评分

---

## Tab 2: 💼 持仓策略

### 2.1 持仓仪表盘

**操作步骤**:
1. 点击"💼 持仓策略" Tab
2. 查看顶部仪表盘区域

**预期结果**:
- ✅ 显示4个核心指标卡片：总市值、总盈亏、盈亏比例、持仓数量
- ✅ 数值用颜色标记（盈利绿色、亏损红色）
- ✅ 显示盈亏比例百分比

### 2.2 行业分布图

**检查项**:
- ✅ 显示持仓行业分布饼图（Plotly交互图表）
- ✅ 鼠标悬停显示行业名称和占比

### 2.3 Top5 持仓与盈亏统计

**检查项**:
- ✅ 显示 Top5 持仓排名表（代码、名称、市值、占比）
- ✅ 显示盈利/亏损持仓统计

### 2.4 止损/止盈提醒

**检查项**:
- ✅ 显示"⚠️ 止损/止盈提醒"区域
- ✅ 触及止损线的股票用红色警告标记
- ✅ 触及止盈线的股票用绿色提示标记

### 2.5 调仓计划

**操作步骤**:
1. 点击"📋 生成调仓计划"按钮

**预期结果**:
- ✅ 显示调仓指令表（操作、代码、方向、数量、原因）
- ✅ 操作类型包括：增持、减持、清仓、新建仓

### 2.6 持仓vs策略对比

**操作步骤**:
1. 在策略选择下拉框中选择一个策略
2. 点击"🔄 对比分析"按钮

**预期结果**:
- ✅ 显示策略建议与当前持仓的差异
- ✅ 标明需要调整的持仓

### 2.7 手动添加持仓

**操作步骤**:
1. 展开"添加持仓"表单
2. 输入股票代码、买入价格、买入数量、止损价、止盈价
3. 点击"添加持仓"按钮

**预期结果**:
- ✅ 显示成功消息
- ✅ 持仓列表更新

---

## Tab 3: 🎯 个股推荐

### 3.1 生成推荐

**操作步骤**:
1. 点击"🎯 个股推荐" Tab
2. 选择策略和股票池
3. 点击"🔍 扫描推荐"按钮

**预期结果**:
- ✅ 显示推荐列表（股票代码、策略建议、信心水平）
- ✅ 按信心水平降序排列
- ✅ 显示买入建议的股票数量统计

### 3.2 策略胜率对比

**检查项**:
- ✅ 显示"📊 策略胜率对比"区域
- ✅ 表格包含：策略名、1周胜率、1月胜率、3月胜率、总推荐数
- ✅ 胜率数值以百分比显示

### 3.3 策略有效性预警

**检查项**:
- ✅ 胜率低于45%的策略显示"⚠️ 警告"标记
- ✅ 预警信息用红色/橙色高亮

### 3.4 胜率柱状图

**检查项**:
- ✅ 显示策略胜率对比柱状图
- ✅ X轴为策略名称，Y轴为胜率
- ✅ 不同时间窗口（1周/1月/3月）分组对比

---

## Tab 4: 📈 行情分析

### 4.1 K线图

**操作步骤**:
1. 点击"📈 行情分析" Tab

**预期结果**:
- ✅ 显示交互式K线图（Plotly candlestick）
- ✅ 包含成交量柱状图
- ✅ 可缩放、拖拽查看历史数据

### 4.2 技术指标

**检查项**:
- ✅ 显示均线（MA5、MA20、MA60）
- ✅ 显示MACD指标
- ✅ 显示RSI指标
- ✅ 指标数值合理

---

## Tab 5: 🔬 因子研究

### 5.1 因子计算

**操作步骤**:
1. 点击"🔬 因子研究" Tab
2. 选择因子类别
3. 点击"计算因子"按钮

**预期结果**:
- ✅ 显示因子值表格
- ✅ 显示因子描述信息

### 5.2 学术因子雷达图

**检查项**:
- ✅ 显示"🎓 学术因子分析"区域
- ✅ 雷达图展示6个维度：市场Beta、规模因子、价值因子、动量因子、质量因子、低波动因子
- ✅ 雷达图可交互（悬停显示具体数值）

### 5.3 因子评级卡片

**检查项**:
- ✅ 每个因子显示评级（A/B/C/D）
- ✅ 显示因子值和评级描述
- ✅ 6个因子分两行排列

---

## Tab 6: 🧪 策略回测

### 6.1 运行回测

**操作步骤**:
1. 点击"🧪 策略回测" Tab
2. 选择一个策略（如"多因子均衡"）
3. 设置初始资金（默认100000）
4. 点击"🚀 运行回测"按钮

**预期结果**:
- ✅ 显示进度提示
- ✅ 回测完成后显示结果

### 6.2 核心指标

**检查项**:
- ✅ 显示4个核心指标卡片：年化收益率、夏普比率、最大回撤、总交易次数
- ✅ 年化收益率和夏普比率为正常数值
- ✅ 最大回撤为负数（以百分比显示）

### 6.3 策略健康评分

**检查项**:
- ✅ 显示"🏥 策略健康评分"区域
- ✅ 综合健康评分（0-100分）
- ✅ 分项评分：盈利能力、风险控制、稳定性
- ✅ 评分用颜色标记（≥80绿色、≥60橙色、<60红色）

### 6.4 权益曲线图

**检查项**:
- ✅ 显示权益曲线折线图
- ✅ X轴为日期，Y轴为资产净值

### 6.5 交易明细

**检查项**:
- ✅ 显示交易记录表（日期、方向、价格、数量、金额）

---

## Tab 7: 📝 交易记录

### 7.1 查看交易记录

**操作步骤**:
1. 点击"📝 交易记录" Tab

**预期结果**:
- ✅ 显示交易历史列表
- ✅ 包含日期、股票代码、方向、价格、数量等信息
- ✅ 可按日期排序

---

## Tab 8: 💰 ETF定投

### 8.1 选择ETF和策略

**操作步骤**:
1. 点击"💰 ETF定投" Tab
2. 输入ETF代码（如 `510300`）
3. 选择定投策略：定期定额(DCA) / 价值平均(VA) / 智能再平衡
4. 设置参数：
   - 定投频率：每周/每两周/每月
   - 每次金额：如 5000 元
5. 点击"📊 开始回测"按钮

**预期结果**:
- ✅ 显示回测进度提示
- ✅ 回测完成后显示结果面板

### 8.2 回测结果

**检查项**:
- ✅ 显示3个核心指标卡片：总投入金额、最终市值、IRR（内部收益率）
- ✅ 显示定投次数
- ✅ IRR以百分比显示

### 8.3 IRR vs 基准对比图

**检查项**:
- ✅ 显示累计投入 vs 市值对比折线图
- ✅ 两条线（蓝色=投入，绿色=市值）清晰可辨
- ✅ 可交互缩放

### 8.4 智能再平衡（选择"智能再平衡"时）

**检查项**:
- ✅ 显示再平衡调仓指令表
- ✅ 包含调仓日期、操作方向、调仓金额

---

## Tab 9: 🎯 目标规划

### 9.1 设置投资目标

**操作步骤**:
1. 点击"🎯 目标规划" Tab
2. 设置参数：
   - 投资期限：如 3 年
   - 目标收益率：如 100%（翻倍）
   - 风险承受等级：低/中/高
   - 初始资金：如 100000
3. 点击"🎯 生成推荐"按钮

**预期结果**:
- ✅ 显示推荐策略列表
- ✅ 每个策略显示：策略名称、匹配度评分、达成概率、预期年化收益
- ✅ 按匹配度降序排列

### 9.2 蒙特卡洛模拟

**检查项**:
- ✅ 显示"🎲 蒙特卡洛模拟"区域
- ✅ 显示模拟结果直方图（收益分布）
- ✅ 显示达成目标的概率
- ✅ 显示最优/最差/平均情景数值
- ✅ 目标线在图中用红色虚线标注

### 9.3 达成路径图

**检查项**:
- ✅ 显示资产增长路径预测图
- ✅ 包含置信区间（如P25-P75范围）

---

## Tab 10: ⚡ 策略优化

### 10.1 ML算法对比

**操作步骤**:
1. 点击"⚡ 策略优化" Tab
2. 点击"🔬 运行ML对比"按钮

**预期结果**:
- ✅ 显示ML算法对比柱状图
- ✅ 包含4个算法：LightGBM、XGBoost、RandomForest、Ridge
- ✅ 对比指标：IC（信息系数）、ICIR、多空收益

### 10.2 策略集成配置

**操作步骤**:
1. 选择集成方法：投票法 / 加权法 / 动态加权
2. 选择子策略（多选）
3. 调整权重滑块（加权法时）
4. 点击"⚡ 运行集成策略"按钮

**预期结果**:
- ✅ 显示集成策略的综合信号
- ✅ 显示各子策略信号对比
- ✅ 显示集成后的信心水平

### 10.3 集成回测结果

**检查项**:
- ✅ 显示集成策略回测指标（年化收益、夏普、最大回撤）
- ✅ 对比集成策略 vs 单一策略的表现

---

## Tab 11: 📋 专业报告

### 11.1 生成报告

**操作步骤**:
1. 点击"📋 专业报告" Tab
2. 选择策略和参数
3. 点击"📊 生成专业报告"按钮

**预期结果**:
- ✅ 显示完整的专业回测报告

### 11.2 核心指标面板（30+指标）

**检查项**:
- ✅ **收益指标**: 总收益率、年化收益率、月均收益率
- ✅ **风险指标**: 年化波动率、最大回撤、最大回撤持续天数
- ✅ **风险调整指标**: 夏普比率、索提诺比率、卡尔玛比率
- ✅ **交易指标**: 总交易次数、胜率、盈亏比
- ✅ **相对基准指标**: Alpha、Beta、信息比率

### 11.3 月度收益热力表

**检查项**:
- ✅ 显示月度收益矩阵（行=年份，列=月份）
- ✅ 正收益用绿色背景
- ✅ 负收益用红色背景
- ✅ 数值以百分比显示

### 11.4 年度收益表

**检查项**:
- ✅ 显示每年的年度收益率
- ✅ 包含年份和收益率列

### 11.5 Top5 回撤事件

**检查项**:
- ✅ 显示历史 Top5 最大回撤事件表
- ✅ 包含：开始日期、结束日期、回撤幅度、持续天数
- ✅ 按回撤幅度降序排列

### 11.6 权益曲线图

**检查项**:
- ✅ 显示详细权益曲线（带回撤阴影区域）
- ✅ 可交互缩放

### 11.7 滚动指标图表

**检查项**:
- ✅ 显示滚动夏普比率折线图
- ✅ 显示滚动波动率折线图
- ✅ 显示滚动回撤折线图

---

## 性能测试

### 页面加载速度

- ✅ 首页加载时间 < 5秒
- ✅ 切换Tab延迟 < 1秒
- ✅ 策略回测运行时间 < 30秒（1年数据）
- ✅ 专业报告生成时间 < 60秒

---

## 异常情况测试

### 无效输入

| 输入 | 位置 | 预期行为 |
|------|------|---------|
| `999999` | 股票代码 | 提示无效或数据获取失败 |
| 空白 | 股票代码 | 使用默认代码 |
| 非常短的日期范围 | 日期选择 | 提示数据不足或显示有限结果 |

### 数据缺失

**测试步骤**:
1. 输入一只停牌或退市股票代码
2. 尝试各Tab功能

**预期**:
- ✅ 显示友好的错误提示（st.warning 或 st.error）
- ✅ 不崩溃
- ✅ 建议更换股票代码

---

## 快速测试检查清单

如果时间有限，请至少完成以下**核心测试**:

### ✅ 核心功能（必测）

- [ ] **个股策略**: 输入`600519`，选择策略，点击分析，查看决策建议和基本面评分
- [ ] **持仓策略**: 查看仪表盘、行业分布图、调仓计划
- [ ] **个股推荐**: 扫描推荐，查看胜率对比表和预警
- [ ] **行情分析**: 查看K线图和技术指标
- [ ] **策略回测**: 运行回测，查看年化收益、夏普比率、健康评分
- [ ] **ETF定投**: 输入510300，选择DCA策略，查看IRR
- [ ] **目标规划**: 设置3年翻倍目标，查看推荐和蒙特卡洛模拟
- [ ] **策略优化**: 运行ML对比，查看算法对比柱状图
- [ ] **专业报告**: 生成报告，查看30+指标和月度收益热力表

### ✅ 数据正确性（必测）

- [ ] 策略信号合理（不全是同一方向）
- [ ] 回测收益率合理（不出现异常高收益如1000%）
- [ ] 因子评分在合理范围内
- [ ] 蒙特卡洛模拟概率在0-100%之间

### ✅ 图表交互（必测）

- [ ] 所有 Plotly 图表可缩放、拖拽
- [ ] 悬停显示数据标签
- [ ] 饼图点击可高亮

---

## 测试记录模板

```
测试日期: ____-__-__
测试人员: [您的名字]
应用版本: v3.0 (Phase 1-9 完整版)

| Tab | 测试项 | 状态 | 备注 |
|-----|-------|------|------|
| 个股策略 | 策略分析 | ✅/❌ | |
| 个股策略 | 多策略对比 | ✅/❌ | |
| 个股策略 | 基本面评分 | ✅/❌ | |
| 持仓策略 | 仪表盘 | ✅/❌ | |
| 持仓策略 | 行业分布图 | ✅/❌ | |
| 持仓策略 | 调仓计划 | ✅/❌ | |
| 个股推荐 | 扫描推荐 | ✅/❌ | |
| 个股推荐 | 胜率对比 | ✅/❌ | |
| 行情分析 | K线图 | ✅/❌ | |
| 因子研究 | 因子计算 | ✅/❌ | |
| 因子研究 | 学术因子雷达图 | ✅/❌ | |
| 策略回测 | 回测运行 | ✅/❌ | |
| 策略回测 | 健康评分 | ✅/❌ | |
| 交易记录 | 记录列表 | ✅/❌ | |
| ETF定投 | DCA回测 | ✅/❌ | |
| ETF定投 | IRR对比图 | ✅/❌ | |
| 目标规划 | 策略推荐 | ✅/❌ | |
| 目标规划 | 蒙特卡洛 | ✅/❌ | |
| 策略优化 | ML对比 | ✅/❌ | |
| 策略优化 | 策略集成 | ✅/❌ | |
| 专业报告 | 30+指标 | ✅/❌ | |
| 专业报告 | 月度收益表 | ✅/❌ | |
| 专业报告 | 回撤分析 | ✅/❌ | |

问题汇总:
1. [严重/一般/轻微] 描述
2. ...
```

---

## 问题反馈

如遇到问题，请提供以下信息:

1. **问题描述**: 详细描述发生了什么
2. **复现步骤**: 如何一步步触发问题
3. **预期结果**: 您期望看到什么
4. **实际结果**: 实际看到了什么
5. **截图**: 如果可能，提供截图
6. **浏览器**: Chrome/Firefox/Safari + 版本号
7. **错误日志**: 查看终端（运行streamlit的窗口）的错误信息
